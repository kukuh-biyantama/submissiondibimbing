ITH StudentGrades AS (
    SELECT
        s.Name,
        s.Marks,
        g.Grade
    FROM Students s
    JOIN Grades g
        ON s.Marks BETWEEN g.Min_Mark AND g.Max_Mark
)
SELECT
    CASE WHEN Grade < 8 THEN NULL ELSE Name END AS Name,
    Grade,
    Marks
FROM StudentGrades
ORDER BY
    Grade DESC,
    CASE WHEN Grade >= 8 THEN Name ELSE '' END ASC,
    CASE WHEN Grade < 8 THEN Marks ELSE NULL END ASC
;
